Version 4
SHEET 1 4188 2852
WIRE -992 32 -992 -16
WIRE -544 32 -544 -16
WIRE -992 160 -992 112
WIRE -544 160 -544 112
WIRE -880 416 -1072 416
WIRE -784 416 -880 416
WIRE -720 416 -784 416
WIRE -576 416 -656 416
WIRE -448 416 -576 416
WIRE -192 416 -448 416
WIRE -112 416 -192 416
WIRE -576 512 -576 480
WIRE -448 512 -448 480
WIRE -1072 528 -1072 480
WIRE -1072 528 -1104 528
WIRE -880 528 -880 480
WIRE -848 528 -880 528
WIRE -192 528 -192 496
WIRE -1072 560 -1072 528
WIRE -880 560 -880 528
WIRE -880 624 -1072 624
WIRE -848 624 -880 624
WIRE -704 1024 -704 1008
WIRE -416 1040 -416 1008
WIRE -416 1040 -480 1040
WIRE -768 1088 -768 1008
WIRE -704 1088 -768 1088
WIRE -640 1088 -640 1008
WIRE -416 1088 -416 1040
WIRE -480 1120 -480 1040
WIRE -768 1136 -768 1088
WIRE -1072 1152 -1136 1152
WIRE -912 1152 -912 1008
WIRE -912 1152 -992 1152
WIRE -800 1152 -912 1152
WIRE -720 1168 -736 1168
WIRE -640 1168 -720 1168
WIRE -560 1168 -640 1168
WIRE -416 1168 -464 1168
WIRE -288 1168 -416 1168
WIRE -176 1168 -208 1168
WIRE -48 1168 -176 1168
WIRE -800 1184 -832 1184
WIRE -912 1248 -912 1216
WIRE -768 1248 -768 1200
WIRE -176 1248 -176 1232
WIRE -928 1312 -960 1312
WIRE -832 1312 -832 1184
WIRE -832 1312 -848 1312
WIRE -800 1312 -832 1312
WIRE -720 1312 -720 1168
WIRE -832 1408 -832 1312
WIRE -800 1664 -1008 1664
WIRE -592 1664 -720 1664
WIRE -320 1664 -528 1664
WIRE -400 1872 -400 1840
WIRE -848 1904 -848 1840
WIRE -448 1936 -448 1888
WIRE -400 1936 -448 1936
WIRE -1328 1952 -1328 1920
WIRE -912 1968 -912 1952
WIRE -848 1968 -912 1968
WIRE -448 1968 -448 1936
WIRE -912 1984 -912 1968
WIRE -528 1984 -528 1664
WIRE -480 1984 -528 1984
WIRE -1008 2000 -1008 1664
WIRE -944 2000 -1008 2000
WIRE -320 2000 -320 1664
WIRE -320 2000 -416 2000
WIRE -160 2000 -320 2000
WIRE -768 2016 -880 2016
WIRE -592 2016 -592 1664
WIRE -592 2016 -624 2016
WIRE -480 2016 -592 2016
WIRE -1216 2032 -1328 2032
WIRE -1120 2032 -1120 1920
WIRE -1120 2032 -1136 2032
WIRE -944 2032 -1120 2032
WIRE -1328 2128 -1328 2112
WIRE -1120 2128 -1120 2096
WIRE -912 2128 -912 2048
WIRE -592 2128 -592 2080
WIRE -448 2128 -448 2032
FLAG -992 -16 dynamo1
IOPIN -992 -16 Out
FLAG -992 160 dynamo2
IOPIN -992 160 Out
FLAG -848 624 0
FLAG -784 416 V_RECT_TP1-IN
IOPIN -784 416 Out
FLAG -192 528 0
FLAG -848 528 dynamo1
IOPIN -848 528 Out
FLAG -1104 528 dynamo2
IOPIN -1104 528 Out
FLAG -576 512 0
FLAG -112 416 V_REGULATED_TP2-IN
IOPIN -112 416 Out
FLAG -448 512 0
FLAG -544 160 0
FLAG -544 -16 Vcc
IOPIN -544 -16 Out
FLAG -768 1248 0
FLAG -960 1312 0
FLAG -1136 1152 dynamo1
IOPIN -1136 1152 Out
FLAG -912 1248 0
FLAG -640 1008 V_REGULATED_TP2-IN
IOPIN -640 1008 Out
FLAG -416 1008 Vcc
IOPIN -416 1008 Out
FLAG -48 1168 ZeroCross
IOPIN -48 1168 Out
FLAG -768 1008 V_REGULATED_TP2-IN
IOPIN -768 1008 Out
FLAG -912 1008 comp_neg
FLAG -832 1408 comp_pos
FLAG -176 1248 0
FLAG -592 2128 0
FLAG -912 2128 0
FLAG -912 1952 V_REGULATED_TP2-IN
IOPIN -912 1952 Out
FLAG -1328 2128 0
FLAG -1328 1920 V_RECT_TP1-IN
IOPIN -1328 1920 Out
FLAG -448 2128 0
FLAG -160 2000 VoltageFollowerOUT
IOPIN -160 2000 Out
FLAG -1120 2128 0
FLAG -1120 1920 PeakDetectorIN
FLAG -592 1664 PeakDetectorOUT
FLAG -400 1840 0
FLAG -848 1840 0
FLAG -704 1008 V_REGULATED_TP2-IN
IOPIN -704 1008 Out
FLAG -448 1888 V_REGULATED_TP2-IN
IOPIN -448 1888 Out
SYMBOL voltage -992 16 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(0 20 100)
SYMBOL res -208 400 R0
SYMATTR InstName R1
SYMATTR Value 120
SYMBOL schottky -1056 480 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value RB500SM-30
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1056 624 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value RB500SM-30
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -864 624 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value RB500SM-30
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -864 480 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value RB500SM-30
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL polcap -592 416 R0
SYMATTR InstName C1
SYMATTR Value 4800u
SYMBOL schottky -720 432 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMATTR Value RB500SM-30
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL Comparators\\LT1716 -768 1168 R0
SYMATTR InstName U2
SYMBOL voltage -544 16 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 3.3
SYMBOL res -832 1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL res -976 1136 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 30k
SYMBOL res -704 1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 47k
SYMBOL diode -896 1216 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D6
SYMATTR Value 1N4148
SYMBOL nmos -560 1120 M90
SYMATTR InstName M1
SYMATTR Value IRFZ46Z
SYMBOL res -656 1072 R0
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res -432 1072 R0
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL polcap -464 416 R0
SYMATTR InstName C2
SYMATTR Value 4800u
SYMBOL cap -192 1168 R0
SYMATTR InstName C4
SYMATTR Value 22n
SYMBOL res -192 1152 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL Opamps\\LT1638 -912 1952 R0
SYMATTR InstName U1
SYMBOL diode -768 2032 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D7
SYMATTR Value 1N4148
SYMBOL cap -608 2016 R0
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL res -1312 2048 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 47k
SYMBOL res -1344 2016 R0
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL Opamps\\LT1638 -448 1936 R0
SYMATTR InstName U3
SYMBOL res -608 2000 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 33r
SYMBOL res -704 1648 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL cap -1136 2032 R0
SYMATTR InstName C5
SYMATTR Value 22n
SYMBOL res -1120 2016 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL cap -416 1872 R0
SYMATTR InstName C6
SYMATTR Value 0.1u
SYMBOL cap -864 1904 R0
SYMATTR InstName C7
SYMATTR Value 0.1u
SYMBOL cap -720 1024 R0
SYMATTR InstName C8
SYMATTR Value 0.1u
TEXT -1000 -272 Left 2 !.tran .1
TEXT -1168 -856 Left 2 ;stock dynamo: 3W, 6V: 500mA over a 12Ohm load\nwheel circumference: approx. 2m, 28 poles\n \nspeed [m/s] - speed [km/h] - freq. [Hz]\n2 - 3.6 - 56\n4 - 14.4 - 112\n6 - 21,6 - 168\n8 - 28,8 - 224\n10 - 36,0 - 280\n12 - 43.2 - 336\n14 - 50,4 - 392\n16 - 57,6 - 448\n20 - 72.7 - 560
